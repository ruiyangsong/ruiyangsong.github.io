<!DOCTYPE html>
<html>
<head>
<title>20200330.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="centermcnncenter"><center>mCNN</center></h1>
<p><strong><center>宋瑞阳</center></strong>
<strong><center>2020/03/30</center></strong>
</br></p>
<hr>
<h2 id="1-%E6%95%B0%E6%8D%AE">1. 数据</h2>
<p>S2648：2648个突变</p>
<h2 id="2-%E7%89%B9%E5%BE%81">2. 特征</h2>
<p>每个原子124维特征</p>
<pre class="hljs"><code><div>        self.keys = ['dist', 'x', 'y', 'z', 'occupancy', 'b_factor',

                     's_H', 's_G', 's_I', 's_E', 's_B', 's_T', 's_C',
                     's_Helix', 's_Strand', 's_Coil',

                     'sa', 'rsa', 'asa', 'phi', 'psi',

                     'ph', 'temperature',

                     'C', 'O', 'N', 'Other',

                     'C_mass', 'O_mass', 'N_mass', 'S_mass',

                     'hydrophobic', 'positive', 'negative', 'neutral', 'acceptor', 'donor', 'aromatic', 'sulphur', 
                     'hydrophobic_bak', 'polar',

                     'fa_atr', 'fa_rep', 'fa_sol', 'fa_intra_rep', 'fa_intra_sol_xover4', 'lk_ball_wtd', 'fa_elec', 'pro_close', 'hbond_sr_bb',
                     'hbond_lr_bb', 'hbond_bb_sc', 'hbond_sc', 'dslf_fa13', 'atom_pair_constraint', 'angle_constraint', 'dihedral_constraint',
                     'omega', 'fa_dun', 'p_aa_pp', 'yhh_planarity', 'ref', 'rama_prepro', 'total',

                     'WT_A', 'WT_R', 'WT_N', 'WT_D', 'WT_C', 'WT_Q', 'WT_E', 'WT_G', 'WT_H', 'WT_I', 'WT_L', 'WT_K', 'WT_M',
                     'WT_F', 'WT_P', 'WT_S', 'WT_T', 'WT_W', 'WT_Y', 'WT_V', 'WT_-',
                     'MT_A', 'MT_R', 'MT_N', 'MT_D', 'MT_C', 'MT_Q', 'MT_E', 'MT_G', 'MT_H', 'MT_I', 'MT_L', 'MT_K', 'MT_M',
                     'MT_F', 'MT_P', 'MT_S', 'MT_T', 'MT_W', 'MT_Y', 'MT_V', 'MT_-',

                     'dC', 'dH', 'dO', 'dN', 'dOther',

                     'dhydrophobic', 'dpositive', 'dnegative', 'dneutral', 'dacceptor', 'ddonor', 'daromatic', 'dsulphur',

                     'dhydrophobic_bak', 'dpolar',

                     'dEntropy', 'entWT', 'entMT']
</div></code></pre>
<h2 id="3%E5%AE%9E%E9%AA%8C">3.实验</h2>
<h3 id="31-%E5%9C%A8%E5%8E%9F%E5%A7%8B%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%A2%9E%E5%8A%A0%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5%E4%BD%BF%E7%94%A8hyperas%E6%90%9C%E7%B4%A2%E8%B6%85%E5%8F%82%E6%95%B0%E7%A9%BA%E9%97%B4">3.1 在原始模型基础上增加残差连接，使用<strong>hyperas</strong>搜索超参数空间</h3>
<ul>
<li>S2648 (neighbor120)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">acc</th>
<th style="text-align:center">rec+</th>
<th style="text-align:center">rec-</th>
<th style="text-align:center">pre+</th>
<th style="text-align:center">pre-</th>
<th style="text-align:center">mcc</th>
<th style="text-align:center">rho</th>
<th style="text-align:center">rmse</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.79</td>
<td style="text-align:center">0.41</td>
<td style="text-align:center"><strong>0.90</strong></td>
<td style="text-align:center"><strong>0.54</strong></td>
<td style="text-align:center">0.84</td>
<td style="text-align:center">0.34</td>
<td style="text-align:center">0.61</td>
<td style="text-align:center"><strong>1.38</strong></td>
</tr>
<tr>
<td style="text-align:center">0.79</td>
<td style="text-align:center"><strong>0.55</strong></td>
<td style="text-align:center">0.86</td>
<td style="text-align:center">0.52</td>
<td style="text-align:center"><strong>0.87</strong></td>
<td style="text-align:center"><strong>0.40</strong></td>
<td style="text-align:center"><strong>0.65</strong></td>
<td style="text-align:center">1.40</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<blockquote>
<p>第1行为之前CNN结果（特征无 Rosetta energy和多序列比对）<br>
第2行为经过超参数搜索得到的网结构的预测结果（基于上述124维特征）</p>
</blockquote>
<h4 id="%E7%BB%93%E8%AE%BA%E9%97%AE%E9%A2%98">结论、问题</h4>
<ol>
<li>在分类评估指标中 acc 和 mcc 相对更重要，现模型在这两种指标上表现更优；在回归指标中, 相关系数 rho 结果更优, rmse略差</li>
<li>在<strong>回归器</strong>训练过程中有这样一种现象：rho 和 rmse总是有些矛盾，即 rmse 不会随着相关系数 rho 的上升而下降，相反 rmse 会随着 rho 上升大概率上升</li>
</ol>
<h3 id="32-%E8%AF%84%E4%BC%B0rosetta%E9%A2%84%E6%B5%8B%E7%9A%84%E7%AA%81%E5%8F%98%E7%BB%93%E6%9E%84%E6%98%AF%E5%90%A6%E5%8F%AF%E7%94%A8%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA">3.2 评估rosetta预测的突变结构是否可用于数据增强</h3>
<p>由于数据本身的不平衡性，过拟合难以避免，数据分布如下：</p>
<center>
<table><tr>
<td><img src="./pics/S1925.png" alt="S1925" height="300"></td>
<td><img src="./pics/S2648.png" alt="S2648" height="300"></td>
</tr></table>
</center>
<p><a href="https://pubs.acs.org/doi/10.1021/acs.jcim.8b00697">deepddg</a>关于overfitting的对比
<img src="./pics/deepddg_overfitting.png" alt="overfitting" height="400"></p>
<p>设计三组平行实验验证<strong>数据增强</strong>是否可行：</p>
<ol>
<li>只使用原始的 wild structure</li>
<li>只是用rosetta的 mutant structure</li>
<li>使用 wild structure 和 mutant structure</li>
</ol>
<p>结果表明 wild &gt; wild + mutant &gt; mutant</p>
<h2 id="4-%E8%A7%82%E5%AF%9Frosetta%E5%92%8Ctrrosetta%E5%BB%BA%E7%AB%8B%E7%9A%84%E7%AA%81%E5%8F%98%E7%BB%93%E6%9E%84">4. 观察Rosetta和TrRosetta建立的突变结构</h2>
<table>
<thead>
<tr>
<th style="text-align:center">key</th>
<th style="text-align:center">PDB</th>
<th style="text-align:center">WILD_TYPE</th>
<th style="text-align:center">CHAIN</th>
<th style="text-align:center">POSITION</th>
<th style="text-align:center">MUTANT</th>
<th style="text-align:center">PH</th>
<th style="text-align:center">TEMPERATURE</th>
<th style="text-align:center">DDG</th>
<th style="text-align:center">RSA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">853</td>
<td style="text-align:center">1RTB</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">A</td>
<td style="text-align:center">97</td>
<td style="text-align:center">A</td>
<td style="text-align:center">5</td>
<td style="text-align:center">63.3</td>
<td style="text-align:center">-12</td>
<td style="text-align:center">2.95</td>
</tr>
<tr>
<td style="text-align:center">855</td>
<td style="text-align:center">1RTB</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">A</td>
<td style="text-align:center">97</td>
<td style="text-align:center">G</td>
<td style="text-align:center">5</td>
<td style="text-align:center">63.3</td>
<td style="text-align:center">-11.7</td>
<td style="text-align:center">2.95</td>
</tr>
<tr>
<td style="text-align:center">1834</td>
<td style="text-align:center">3SSI</td>
<td style="text-align:center">V</td>
<td style="text-align:center">A</td>
<td style="text-align:center">13</td>
<td style="text-align:center">G</td>
<td style="text-align:center">7</td>
<td style="text-align:center">82.21</td>
<td style="text-align:center">-10.3</td>
<td style="text-align:center">36.56</td>
</tr>
<tr>
<td style="text-align:center">263</td>
<td style="text-align:center">1BNI</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">A</td>
<td style="text-align:center">103</td>
<td style="text-align:center">F</td>
<td style="text-align:center">6.3</td>
<td style="text-align:center">25</td>
<td style="text-align:center">0</td>
<td style="text-align:center">28.22</td>
</tr>
<tr>
<td style="text-align:center">68</td>
<td style="text-align:center">1AJ3</td>
<td style="text-align:center">Q</td>
<td style="text-align:center">A</td>
<td style="text-align:center">86</td>
<td style="text-align:center">A</td>
<td style="text-align:center">7</td>
<td style="text-align:center">25</td>
<td style="text-align:center">0</td>
<td style="text-align:center">63.44</td>
</tr>
<tr>
<td style="text-align:center">1082</td>
<td style="text-align:center">1FVK</td>
<td style="text-align:center">H</td>
<td style="text-align:center">A</td>
<td style="text-align:center">32</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">7</td>
<td style="text-align:center">30</td>
<td style="text-align:center">6.8</td>
<td style="text-align:center">43.27</td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><strong>1A23</strong></td>
<td style="text-align:center"><strong>H</strong></td>
<td style="text-align:center"><strong>A</strong></td>
<td style="text-align:center"><strong>32</strong></td>
<td style="text-align:center"><strong>Y</strong></td>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>30</strong></td>
<td style="text-align:center"><strong>0.5</strong></td>
<td style="text-align:center"><strong>31.56</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>1A23</strong></td>
<td style="text-align:center"><strong>H</strong></td>
<td style="text-align:center"><strong>A</strong></td>
<td style="text-align:center"><strong>32</strong></td>
<td style="text-align:center"><strong>Y</strong></td>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>30</strong></td>
<td style="text-align:center"><strong>6.8</strong></td>
<td style="text-align:center"><strong>31.56</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>1A23</strong></td>
<td style="text-align:center"><strong>H</strong></td>
<td style="text-align:center"><strong>A</strong></td>
<td style="text-align:center"><strong>32</strong></td>
<td style="text-align:center"><strong>Y</strong></td>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>30</strong></td>
<td style="text-align:center"><strong>6.8</strong></td>
<td style="text-align:center"><strong>31.56</strong></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<ol>
<li>key 854</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key854.png" alt="RO_key854" height="200"><center>RSA=2.59%, DDG=-12</center></td>
    <td><img src="./pics/TR_key854.png" alt="TR_key854" height="200"><center>RSA=2.59%, DDG=-12<center></td>
    <td><img src="./pics/ROTR_key854.png" alt="ROTR_key854" height="200"><center>RSA=2.59%, DDG=-12</center></td>
  </tr>
</table>
</center>
<ol start="2">
<li>key 855</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key855.png" alt="RO_key855" height="200"><center>RSA=2.95%, DDG=-11.7</center></td>
    <td><img src="./pics/TR_key855.png" alt="TR_key855" height="200"><center>RSA=2.95%, DDG=-11.7<center></td>
    <td><img src="./pics/ROTR_key855.png" alt="ROTR_key855" height="200"><center>RSA=2.95%, DDG=-11.7</center></td>
  </tr>
</table>
</center>
<ol start="3">
<li>key 1834</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key1834.png" alt="RO_key1834" height="200"><center>RSA=28.22%, DDG=-10.3</center></td>
    <td><img src="./pics/TR_key1834.png" alt="TR_key1834" height="200"><center>RSA=28.22%, DDG=-10.3, 不吻合但RSA偏大<center></td>
    <td><img src="./pics/ROTR_key1834.png" alt="ROTR_key1834" height="200"><center>RSA=28.22%, DDG=-10.3</center></td>
  </tr>
</table>
</center>
<ol start="4">
<li>key 263</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key263.png" alt="RO_key263" height="200"><center>RSA=63.44%, DDG=0</center></td>
    <td><img src="./pics/TR_key263.png" alt="TR_key263" height="200"><center>RSA=63.44%, DDG=0<center></td>
    <td><img src="./pics/ROTR_key263.png" alt="ROTR_key263" height="200"><center>RSA=63.44%, DDG=0</center></td>
  </tr>
</table>
</center>
<ol start="5">
<li>key 68</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key68.png" alt="RO_key68" height="200"><center>RSA=43.27%, DDG=0</center></td>
    <td><img src="./pics/TR_key68.png" alt="TR_key68" height="200"><center>RSA=43.27%, DDG=0<center></td>
    <td><img src="./pics/ROTR_key68.png" alt="ROTR_key68" height="200"><center>RSA=43.27%, DDG=0</center></td>
  </tr>
</table>
</center>
<ol start="6">
<li>key 1082</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key1082.png" alt="RO_key1082" height="200"><center>RSA=31.56%, DDG=6.8</center></td>
    <td><img src="./pics/TR_key1082.png" alt="TR_key1082" height="200"><center>RSA=31.56%, DDG=6.8<center></td>
    <td><img src="./pics/ROTR_key1082.png" alt="ROTR_key1082" height="200"><center>RSA=31.56%, DDG=6.8</center></td>
  </tr>
</table>
</center>
<ol start="7">
<li>key 4</li>
</ol>
<center>
<table border="1">
  <tr>
    <th>Rosetta_ref and Rosetta_mut alignment</th>
    <th>TrRosetta_ref and TrRosetta_mut alignment</th>
    <th>Rosetta_ref and TrRosetta_mut alignment</th>
  </tr>
  <tr>
    <td><img src="./pics/RO_key4.png" alt="RO_key4" height="200"><center>RSA=2.59%, DDG=[6.8|0.5]</center></td>
    <td><img src="./pics/TR_key4.png" alt="TR_key4" height="200"><center>RSA=2.59%, DDG=[6.8|0.5]<center></td>
    <td><img src="./pics/ROTR_key4.png" alt="ROTR_key4" height="200"><center>RSA=2.59%, DDG=[6.8|0.5], DDG values are in conflict</center></td>
  </tr>
</table>
</center>
<h3 id="%E7%BB%93%E8%AE%BA">结论</h3>
<p>Rosetta_ref 和 Rosetta_mut 的空间结构几乎一样，会导致上述数据增强引入噪声，反而不利于网络学习
TrRosetta_ref 和 TrRosetta_mut 结构中二级结构的比较与ddg呈现出较大相关性.</p>
<h2 id="5-%E6%96%87%E7%8C%AE">5. 文献</h2>
<p><a href="https://pubs.acs.org/doi/10.1021/acs.jcim.8b00697">DeepDDG2019cao</a>通过ProTherm和文献挖掘收集了5720条突变数据，通过和S1925、S2648整合后发现出现1595条完全重复的数据，进一步有2775条重复数据（实验条件作为主键），4369条重复数据（实验条件不作为主键），<strong>即数据中出现大量冲突，这可能暗示了数据本身质量较差</strong>
此外DeepDDG中也考虑了反向突变进行数据增强，利用modeller创建突变之后结构，web server测试时返回了一个错误。</p>
<p>另外测试了CATHER的一个例子key855，结果mut结构和ref几乎一致，如下图</p>
<center><img src="./pics/ROCA_key855.png" alt="RO_key4" height="300"><center>RSA=2.95%, DDG=-11.7</center></center>
<h2 id="5-appendix-%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84">5. appendix (网络结构)</h2>
<p>利用<a href="https://github.com/maxpumperla/hyperas">hyperas</a>搜索超参数空间得到,以classifier为例，超参数空间为：</p>
<pre class="hljs"><code><div># setHyperParams------------------------------------------------------------------------------------------------
        batch_size = 64
        epochs = {{choice([50,100,150,200,250])}}

        lr = {{loguniform(np.log(1e-4), np.log(1e-2))}}

        optimizer = {{choice(['adam','sgd','rmsprop'])}}

        activator = {{choice(['elu', 'relu', 'tanh'])}}

        basic_conv2D_layers     = {{choice([1, 2])}}
        basic_conv2D_filter_num = {{choice([16, 32])}}

        loop_dilation2D_layers = {{choice([2, 4, 6])}}
        loop_dilation2D_filter_num = {{choice([16, 32, 64])}}#used in the loop
        loop_dilation2D_dropout_rate = {{uniform(0.001, 0.35)}}
        dilation_lower = 2
        dilation_upper = 16

        reduce_layers = 3  # conv 3 times: 120 =&gt; 60 =&gt; 30 =&gt; 15
        reduce_conv2D_filter_num = {{choice([8, 16, 32])}}#used for reduce dimention
        reduce_conv2D_dropout_rate = {{uniform(0.001, 0.25)}}
        residual_stride = 2

        dense1_num = {{choice([64, 128, 256])}}
        dense2_num = {{choice([32, 64])}}

        drop_num = {{uniform(0.0001, 0.3)}}

        kernel_size=(3,3)
        pool_size=(2,2)
        initializer='random_uniform'
        padding_style='same'
        loss_type='binary_crossentropy'
        metrics = ('accuracy',)


        my_callbacks = [
            callbacks.ReduceLROnPlateau(
                monitor='val_loss',
                factor=0.8,
                patience=10,
                )
            ]

        if lr &gt; 0:
            if optimizer == 'adam':
                chosed_optimizer = optimizers.Adam(lr=lr)
            elif optimizer == 'sgd':
                chosed_optimizer = optimizers.SGD(lr=lr)
            elif optimizer == 'rmsprop':
                chosed_optimizer = optimizers.RMSprop(lr=lr)
</div></code></pre>
<p><img src="./pics/classifier.png" alt="alt text" title="classifier"></p>
<blockquote>
<p>分类器</p>
</blockquote>
<p><img src="./pics/regressor.png" alt="alt text" title="regressor"></p>
<blockquote>
<p>回归器</p>
</blockquote>

</body>
</html>
